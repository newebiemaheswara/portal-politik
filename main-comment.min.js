var list=document.getElementsByClassName("commentAvatar"),w=document.documentElement.clientWidth;function stringToHslColor(e){e=e.toUpperCase();for(var t=0,o=0;o<e.length;o++){var n=(t=e.charCodeAt(o))-64;if(o>0)l=(l+((t<<5)-t))%360,i+=n*Math.floor(2.5),s-=n*Math.floor(30/26);else var l=Math.floor(13.846153846153847*n),i=30,s=80}return"hsl("+l+","+i+"%, "+s+"%)"}function applyHSLColor(e,t){e.style.backgroundColor=stringToHslColor(t)}function scrollTo(e,t,o){if(!(o<=0)){var n=(t-e.scrollTop)/o*10;setTimeout((function(){e.scrollTop=e.scrollTop+n,e.scrollTop!=t&&scrollTo(e,t,o-10)}),10)}}function findPos(e){var t=0;if(e.offsetParent){do{t+=e.offsetTop}while(e=e.offsetParent);return[t]}}for(var i=0;i<list.length;i++){var t=list[i].getAttribute("data-init");applyHSLColor(list[i],t)}var btntop=document.getElementById("comment-buble");function commentModal(e,t){if(openModal(e),t){let e=document.querySelector('#kcm-modals [data-modal-target="comment-delete"] [data-item-id]');e&&(console.log(e),e.setAttribute("data-item-id",t))}}function closeModal(){let e=document.getElementById("kcm-modals");if(e){document.body.classList.remove("modals","--modalsComment");let t=e.firstElementChild;for(;t.firstChild;)t.removeChild(t.firstChild)}}function closeModalDiscard(e,t){closeModal();let o=e.getAttribute("data-item-mode"),n=e.getAttribute("data-item-id");if(o&&n){let e=document.getElementById(n);e&&(t?(formToggle(e,o),"reply"==o&&(e.querySelector("."+o+"_form .commentTextarea").value="")):e.querySelector("."+o+"_form .commentTextarea").focus())}}function clearModalsContent(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function openModal(e){let t=document.querySelector("[data-modal-target="+e+"]"),o=document.getElementById("kcm-modals");if(o)if(t){{let e=o.firstElementChild;clearModalsContent(e),document.body.classList.add("modals","--modalsComment");let n=t.cloneNode(!0);e.appendChild(n)}o.addEventListener("click",(function(e){e.target.matches("[data-modal-button=dismiss]")&&closeModal(),e.target.matches("[data-form=copyLinkUrl]")&&(e.preventDefault(),copyLink("copyLinkUrl",e))}))}else console.log("unknown modal target");else console.log("template modals not found")}btntop&&btntop.addEventListener("click",(function(e){e.preventDefault();var t=findPos(document.getElementById(this.getAttribute("href").substring(1)));scrollTo(document.documentElement,t-100,200)}));let textareas=document.querySelectorAll(".commentTextarea"),hiddenDiv=document.createElement("div"),content=null;for(let e of textareas)e.classList.add("txtstuff");hiddenDiv.classList.add("commentTextarea-hide"),hiddenDiv.style.display="none",hiddenDiv.style.whiteSpace="pre-wrap",hiddenDiv.style.wordWrap="break-word";for(let e of textareas)!function(e){e.addEventListener("input",(function(){e.parentNode.appendChild(hiddenDiv),e.style.resize="none",content=e.value,content=content.replace(/\n/g,"<br>"),hiddenDiv.innerHTML=content+'<br style="line-height: 3px;">',hiddenDiv.style.visibility="hidden",hiddenDiv.style.display="block",e.style.height=hiddenDiv.offsetHeight+"px",hiddenDiv.style.visibility="visible",hiddenDiv.style.display="none"}))}(e);function addEmoji(e,t){let o=e.parentElement.closest(".commentForm-box");o.classList.toggle("-active"),o.querySelector(".commentTextarea").focus();let n=o.querySelector(".commentTextarea"),l=n.selectionStart,i=n.selectionEnd;n.value=`${n.value.substring(0,l)}${t}${n.value.substring(i,n.value.length)}`}function commentEditForm(e,t){let o=document.getElementById(t);o&&editToggle(o)}function commentReplyForm(e,t,o,n,l){let i=e.closest(".commentItem"),s=i.querySelector("."+o+"_form .commentTextarea");if(s)if(s.value.length>0){openModal("comment-cancel");let e=document.querySelectorAll('#kcm-modals [data-modal-target="comment-cancel"] .button');e&&e.forEach((function(e){e.setAttribute("data-item-id",n),e.setAttribute("data-item-mode",o)}))}else formToggle(i,o)}function editToggle(e){let t=e.querySelector(".edit_form"),o=e.querySelector(".commentContent"),n=o.clientHeight+3;if(console.log(n),t.querySelector(".commentForm-box").classList.remove("-active"),t){let e=t.querySelector(".commentTextarea");"none"===t.style.display?(t.style.display="block",e.style.minHeight=n+"px",e.focus(),o.style.display="none"):(t.style.display="none",e.style.minHeight="none",o.style.display="block")}}function formToggle(e,t){let o=e.querySelector(".--reply .commentButton.action"),n=e.querySelector(".commentContent"),l=e.querySelector("."+t+"_form");l.querySelector(".commentForm-box").classList.remove("-active"),"none"===l.style.display?(l.style.display="block","edit"==t&&(n.style.display="none"),o&&(o.innerHTML="Batal")):(l.style.display="none","edit"==t&&(n.style.display="block"),o&&(o.innerHTML="Balas"))}function alertToast(e,t){let o=document.querySelector("[data-toast]");if(o){o.firstElementChild.innerHTML=e,o.classList.remove("-hide"),o.classList.add("-show");let n,l=o.getElementsByTagName("a")[0];l&&(t?(n=25,l.innerHTML="Lihat",l.href=t):(n=15,l.innerHTML="Oke",l.href="#"),l.addEventListener("click",(function(e){e.preventDefault(),t?window.location.href=t:o.classList.add("-hide")}))),alertToastAutoDismiss(o,n)}}function alertToastAutoDismiss(e,t){let o=1,n=setInterval((()=>{o++,o==t&&(e.classList.remove("-show"),e.classList.add("-hide")),o==t+1&&(e.classList.remove("-hide"),clearInterval(n))}),200)}function commentDelete(e,t){commentItemDelete(t),alertToast(e),closeModal()}function commentItemDelete(e){let t=e.getAttribute("data-item-id");if(t){let e=document.getElementById(t);e&&e.remove()}}function commentSubmit(e,t,o,n){if(alertToast(t),closeModal(),clearTextComment(e),n){let e=document.getElementById(n);e&&(formToggle(e,o),"edit"==o&&e.querySelector(".commentContent-inner").classList.add("edited"))}}function showMore(e){e.parentElement.classList.add("commentReply-open"),e.parentNode.querySelector(".comment_e span").classList.remove("hidden"),e.parentNode.querySelector(".LessLink").classList.remove("hidden"),e.classList.add("hidden")}function showLess(e){e.parentElement.classList.remove("commentReply-open"),e.parentNode.querySelector(".comment_e span").classList.add("hidden"),e.parentNode.querySelector(".MoreLink").classList.remove("hidden"),e.classList.add("hidden")}function func(e){e.parentElement.classList.toggle("commentReply-open")}let mfm=document.querySelectorAll(".commentTextarea");function commentLike(e){let t=e.parentElement.parentElement;e.classList.contains("-active")?e.classList.remove("-active"):e.classList.add("-active");let o=t.querySelector(".commentDislike");o&&o.classList.remove("-active")}function commentDislike(e){let t=e.parentElement.parentElement;e.classList.contains("-active")?e.classList.remove("-active"):e.classList.add("-active");let o=t.querySelector(".commentLike");o&&o.classList.remove("-active")}function clearTextComment(e){let t=e.closest(".commentForm");if(t){let e=t.getElementsByTagName("textarea")[0];e&&(e.value="")}}mfm&&mfm.forEach((function(e,t){e.onfocus=function(){e.closest(".commentForm-box").classList.add("-active")}}));